## 宝塔安装后给出的外网地址是 IPv6 的

翻开源码发现宝塔是根据地址 `https://www.bt.cn/Api/getIpAddress` 获取到的 IP 类型去选择使用 IPv4 还是 IPv6 的方式启动服务。

但是现在 IPv6 的普及程度仍然很低。很多的路由默认是不开启 IPv6 的。这就导致浏览器没法访问相应的 IPv6 的网址。因此必须修改为 IPv4 的方式启动服务。

测试的时候发现当前宝塔默认是 IPv6 的,所以使用 IPv6 的方式启动服务。想要解决这个问题。通过 ping4 去获取 `www.bt.cn` 域名的 IPv4 地址，并且再本地对 hosts 进行修改。

由于 hosts 文件拥有最高优先级。就可以让宝塔只使用 IPv4 的方式启动服务。

但是这样设置存在问题。会导致无法登录和绑定。即使使用本地的 ip。

## 宝塔的本地登录页面一直无法加载出前端页面，即使加载出来绑定也无响应

这应该是新版本的问题。需要官网的强行校验。或者说某些服务使用到了官网的。之前配置了 hosts 对域名和 ip 进行了绑定，但实际上可能由于分布式的原因,导致某些服务无法正常访问。就一直无法登录。

并且之前的宝塔运行会生成一些缓存文件、这些文件会干扰。所以即使取消 hosts 的绑定,宝塔也无法正常登录。

官方给出的卸载并不能卸载干净，还需要删除 `/www` 目录。再重新安装即可。但这样之前的 IPv6 的问题还是没有解决。

唯一的方法就只能禁用 IPv6。